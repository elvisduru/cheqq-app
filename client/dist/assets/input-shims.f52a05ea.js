import{d as b,e as A,f as B,b as C,p as T,g as M,h as N,j as p}from"./index.2430fd47.js";/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */const w=new WeakMap,L=(e,t,o,r=0)=>{w.has(e)!==o&&(o?x(e,t,r):R(e,t))},P=e=>e===e.getRootNode().activeElement,x=(e,t,o)=>{const r=t.parentNode,n=t.cloneNode(!1);n.classList.add("cloned-input"),n.tabIndex=-1,r.appendChild(n),w.set(e,n);const d=e.ownerDocument.dir==="rtl"?9999:-9999;e.style.pointerEvents="none",t.style.transform=`translate3d(${d}px,${o}px,0) scale(0)`},R=(e,t)=>{const o=w.get(e);o&&(w.delete(e),o.remove()),e.style.pointerEvents="",t.style.transform=""},K=(e,t,o)=>{if(!o||!t)return()=>{};const r=c=>{P(t)&&L(e,t,c)},n=()=>L(e,t,!1),s=()=>r(!0),d=()=>r(!1);return A(o,"ionScrollStart",s),A(o,"ionScrollEnd",d),t.addEventListener("blur",n),()=>{b(o,"ionScrollStart",s),b(o,"ionScrollEnd",d),t.addEventListener("ionBlur",n)}},y="input, textarea, [no-blur], [contenteditable]",_=()=>{let e=!0,t=!1;const o=document,r=()=>{t=!0},n=()=>{e=!0},s=d=>{if(t){t=!1;return}const c=o.activeElement;if(!c||c.matches(y))return;const a=d.target;a!==c&&(a.matches(y)||a.closest(y)||(e=!1,setTimeout(()=>{e||c.blur()},50)))};return A(o,"ionScrollStart",r),o.addEventListener("focusin",n,!0),o.addEventListener("touchend",s,!1),()=>{b(o,"ionScrollStart",r,!0),o.removeEventListener("focusin",n,!0),o.removeEventListener("touchend",s,!1)}},O=.3,F=(e,t,o)=>{const r=e.closest("ion-item,[ion-item]")||e;return k(r.getBoundingClientRect(),t.getBoundingClientRect(),o,e.ownerDocument.defaultView.innerHeight)},k=(e,t,o,r)=>{const n=e.top,s=e.bottom,d=t.top,c=Math.min(t.bottom,r-o),a=d+15,f=c*.75-s,m=a-n,i=Math.round(f<0?-f:m>0?-m:0),u=Math.min(i,n-d),v=Math.abs(u)/O,g=Math.min(400,Math.max(150,v));return{scrollAmount:u,scrollDuration:g,scrollPadding:o,inputSafeY:-(n-a)+4}},H=(e,t,o,r,n)=>{let s;const d=a=>{s=T(a)},c=a=>{if(!s)return;const l=T(a);!Y(6,s,l)&&!P(t)&&(a.stopPropagation(),U(e,t,o,r,n))};return e.addEventListener("touchstart",d,!0),e.addEventListener("touchend",c,!0),()=>{e.removeEventListener("touchstart",d,!0),e.removeEventListener("touchend",c,!0)}},U=async(e,t,o,r,n)=>{if(!o&&!r)return;const s=F(e,o||r,n);if(o&&Math.abs(s.scrollAmount)<4){t.focus();return}if(L(e,t,!0,s.inputSafeY),t.focus(),M(()=>e.click()),typeof window!="undefined"){let d;const c=async()=>{d!==void 0&&clearTimeout(d),window.removeEventListener("ionKeyboardDidShow",a),window.removeEventListener("ionKeyboardDidShow",c),o&&await p(o,0,s.scrollAmount,s.scrollDuration),L(e,t,!1,s.inputSafeY),t.focus()},a=()=>{window.removeEventListener("ionKeyboardDidShow",a),window.addEventListener("ionKeyboardDidShow",c)};if(o){const l=await N(o),f=l.scrollHeight-l.clientHeight;if(s.scrollAmount>f-l.scrollTop){t.type==="password"?(s.scrollAmount+=50,window.addEventListener("ionKeyboardDidShow",a)):window.addEventListener("ionKeyboardDidShow",c),d=setTimeout(c,1e3);return}}c()}},Y=(e,t,o)=>{if(t&&o){const r=t.x-o.x,n=t.y-o.y;return r*r+n*n>e*e}return!1},D="$ionPaddingTimer",$=e=>{const t=document,o=n=>{I(n.target,e)},r=n=>{I(n.target,0)};return t.addEventListener("focusin",o),t.addEventListener("focusout",r),()=>{t.removeEventListener("focusin",o),t.removeEventListener("focusout",r)}},I=(e,t)=>{var o,r;if(e.tagName!=="INPUT"||e.parentElement&&e.parentElement.tagName==="ION-INPUT"||((r=(o=e.parentElement)===null||o===void 0?void 0:o.parentElement)===null||r===void 0?void 0:r.tagName)==="ION-SEARCHBAR")return;const n=B(e);if(n===null)return;const s=n[D];s&&clearTimeout(s),t>0?n.style.setProperty("--keyboard-offset",`${t}px`):n[D]=setTimeout(()=>{n.style.setProperty("--keyboard-offset","0px")},120)},q=!0,G=!0,j=e=>{const t=document,o=e.getNumber("keyboardHeight",290),r=e.getBoolean("scrollAssist",!0),n=e.getBoolean("hideCaretOnScroll",!0),s=e.getBoolean("inputBlurring",!0),d=e.getBoolean("scrollPadding",!0),c=Array.from(t.querySelectorAll("ion-input, ion-textarea")),a=new WeakMap,l=new WeakMap,f=async i=>{await new Promise(S=>C(i,S));const u=i.shadowRoot||i,h=u.querySelector("input")||u.querySelector("textarea"),v=B(i),g=v?null:i.closest("ion-footer");if(!!h){if(!!v&&n&&!a.has(i)){const S=K(i,h,v);a.set(i,S)}if((!!v||!!g)&&r&&!l.has(i)){const S=H(i,h,v,g,o);l.set(i,S)}}},m=i=>{if(n){const u=a.get(i);u&&u(),a.delete(i)}if(r){const u=l.get(i);u&&u(),l.delete(i)}};s&&q&&_(),d&&G&&$(o);for(const i of c)f(i);t.addEventListener("ionInputDidLoad",i=>{f(i.detail)}),t.addEventListener("ionInputDidUnload",i=>{m(i.detail)})};export{j as startInputShims};
